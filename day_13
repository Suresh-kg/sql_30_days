ðŸš€ Day 13 â€“ Amazon SQL Interview (Price Drop Detection)
Not every analytics problem is about growth.
Sometimes itâ€™s about catching the drop ðŸ“‰
ðŸ“Œ Business Problem
Identify price drops for products.
Rule:
Show only cases where the current price is lower than the previous price
(Compare consecutive price changes only).

âœ… Expected Output
Only rows with actual price decreases appear.
Increases or no-change rows are ignored.
ðŸ§© SQL Solution (Simple & Interview-Ready)
WITH t AS (
    SELECT 
        product_id,
        price_date,
        price,
        LAG(price) OVER (
            PARTITION BY product_id
            ORDER BY price_date
        ) AS previous_price
    FROM product_prices
)
SELECT 
    product_id,
    price_date,
    previous_price,
    price AS current_price
FROM t
WHERE price < previous_price;

ðŸ“Œ Why Interviewers Like This
â€¢	Clear use of LAG()
â€¢	Correct consecutive comparison
â€¢	No overengineering
â€¢	Easy to explain in one minute
Price tracking, alerts, and trend monitoring all start with logic like this.
Ready for Day 14 ðŸ˜„
#SQL #Amazon #DataAnalytics #InterviewPrep #WindowFunctions #30DaysOfSQL
