
##DAY- 4
ğŸš€ SQL Interview Problem â€“ Top-N per Category (Must-Know)

This is one of the most frequently asked SQL interview questions
for Data Analyst & Data Engineer roles.

ğŸ¯ Interview Question

Find the top 2 products per category by total revenue.

ğŸ“Œ Revenue = quantity Ã— price

ğŸ§  How Interviewers Expect You to Think

This problem tests:

âœ… Aggregation logic
âœ… CTE
âœ… Window functions
âœ… Ranking within groups

The correct approach is 2-step thinking:
1ï¸âƒ£ Aggregate revenue at (category, product) level
2ï¸âƒ£ Rank products within each category

ğŸ§© SQL Solution (Interview-Ready)
WITH t AS (
    SELECT
        category,
        product_id,
        SUM(quantity * price) AS total_revenue
    FROM orders
    GROUP BY category, product_id
),
ranked AS (
    SELECT
        category,
        product_id,
        total_revenue,
        ROW_NUMBER() OVER (
            PARTITION BY category
            ORDER BY total_revenue DESC
        ) AS rn
    FROM t
)
SELECT
    category,
    product_id,
    total_revenue
FROM ranked
WHERE rn <= 2
ORDER BY total_revenue DESC;

âš ï¸ Important Interview Insight

ğŸ‘‰ This solution uses ROW_NUMBER(), which:

Returns exactly 2 products per category

Breaks ties arbitrarily if revenues are equal

ğŸ’¡ For more efficient and business-accurate outcomes,
you can use DENSE_RANK() instead.

Why?

DENSE_RANK() handles ties correctly

Returns all top performers, not forced limits

ğŸ“Œ Example:
If 3 products share the same top revenue,
ROW_NUMBER() â†’ 2 products
DENSE_RANK() â†’ all 3 products

Interviewers LOVE when you mention this ğŸ‘Œ

âœ… What This Question Really Tests

Do you understand ranking vs grouping?
Can you handle real business edge cases?
Do you know when to choose ROW_NUMBER vs DENSE_RANK?

If yes â†’ youâ€™re interview-ready ğŸš€

More real SQL interview problems coming soon.
ğŸ‘‡ Drop your alternative approach in comments

#SQL #DataAnalytics #DataEngineering
#InterviewPrep #WindowFunctions #TopN #30DaysOfSQL
