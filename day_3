
Day 3 â€“ PayPal SQL Interview Problem (Advanced)
In fintech interviews, SQL isnâ€™t about totals.
 Itâ€™s about patterns, sequences, and intent ğŸ’³âš ï¸
ğŸ“Œ Business Problem
PayPal wants to identify users who had:
ğŸ‘‰ A FAILED transaction immediately followed by a SUCCESS transaction
This pattern helps teams:
Detect payment retries
Analyze checkout friction
Flag UX or fraud-related issues.

ğŸ¯ Interview Question
" Find users where a FAILED transaction is immediately followed by a SUCCESS transaction. "

ğŸ” Interview Constraints (Very Important)
â€œImmediatelyâ€ = next transaction in time
Order strictly by txn_date
Ignore users with only one transaction
Output user_id only
Each user appears once
ğŸ§  How Interviewers Expect You to Think
This is sequence analysis, not aggregation.
You must:
 âœ… Preserve transaction order
 âœ… Compare current row with the previous row
 âœ… Detect a FAILED â†’ SUCCESS pattern
ğŸ’¡ Best tool here: window functions

âœ… Why This Solution Is Strong
âœ” Uses LAG() for row-to-row comparison
 âœ” Respects transaction order
 âœ” Detects exact sequence, not just existence
 âœ” Clean, readable, and interview-safe

ğŸ“Œ Interview Insight:
 This exact logic is used in:
Payment retry analysis
Funnel drop-off detection
Fraud & anomaly pipelines
If youâ€™re comfortable with sequence-based SQL,
 youâ€™re operating at a senior analytics / data engineer level.
More real interview SQL problems coming ğŸš€

 ğŸ‘‡ Drop your alternative solution (LEAD, self-join?) in comments
hashtag#SQL hashtag#PayPal hashtag#DataAnalytics hashtag#DataEngineering
 hashtag#WindowFunctions hashtag#FinTech hashtag#InterviewPrep hashtag#30DaysOfSQL
