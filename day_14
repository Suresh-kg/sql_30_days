ðŸš€ Day 14 â€“ Microsoft SQL Interview (Latest Status Problem)
This question looks easy.
But it appears in many real Data Engineer interviews.

ðŸ“Œ Business Problem
Users can change subscription status over time.
We need to answer:
What is the current (latest) status of each user?

ðŸŽ¯ Interview Task
Return:
â€¢	user_id
â€¢	latest_status
â€¢	status_date
Rules:
â€¢	Use status_date to determine the latest record
â€¢	One row per user
â€¢	Must scale for many status changes

ðŸ§© SQL Solution (Clean & Scalable)
WITH t AS (
    SELECT 
        user_id,
        status,
        status_date,
        ROW_NUMBER() OVER (
            PARTITION BY user_id
            ORDER BY status_date DESC
        ) AS rn
    FROM user_status
)
SELECT 
    user_id,
    status AS latest_status,
    status_date
FROM t
WHERE rn = 1;

ðŸ“Œ Why This Is a Strong Interview Answer
â€¢	Uses proper partitioning
â€¢	Correctly orders by latest date
â€¢	Returns exactly one row per user
â€¢	Clean, readable, production-safe

This pattern is everywhere:
â€¢	Subscription systems
â€¢	Account state tracking
â€¢	Order status pipelines
Sometimes strong SQL is just about getting the latest truth correctly.

Ready for Day 15 ðŸ˜„
#SQL #Microsoft #DataEngineering #InterviewPrep #WindowFunctions #30DaysOfSQL

